var idbKeyval=function(e){"use strict";class t{constructor(e="keyval-store",t="keyval",r=1){this.dbName=e,this.storeName=t,this._dbp=new Promise((n,o)=>{const i=indexedDB.open(e,r);i.onerror=(()=>o(i.error)),i.onsuccess=(()=>n(i.result)),i.onupgradeneeded=(()=>{i.result.objectStoreNames.contains("keysToExpire")||i.result.createObjectStore("keysToExpire"),i.result.createObjectStore(t)})})}_withIDBStore(e,t){return this._dbp.then(r=>new Promise((n,o)=>{const i=r.transaction(this.storeName,e);i.oncomplete=(()=>n()),i.onabort=i.onerror=(()=>o(i.error)),t(i.objectStore(this.storeName))}))}}let r,n;function o(){return Math.round((new Date).getTime()/1e3)}function i(e,r){return new t(e,r)}function s(){return r||(r=new t),r}function u(e){return n||(n=new t(e,"keysToExpire"),window.setInterval(function(){c(n).then(t=>{let r=o();for(let o of t)l(o,n).then(t=>{let s=t;s&&s.validUntil<r&&(a(s.key,i(e,s.store)),a(o,n))})})},6e4)),n}function l(e,t=s()){let r,i=t.storeName;if("keysToExpire"!=i){n||(n=u(t.dbName));let s=null,c=null,h=l(i+"_"+e,n).then(r=>{let u=o();r&&r.validUntil<u&&(s=a(e,t),c=a(i+"_"+e,n))});return new Promise(function(n,o){h.then(()=>{if(s&&c)Promise.all([s,c]).then(e=>{n(void 0)});else{t._withIDBStore("readonly",t=>{r=t.get(e)}).then(()=>r.result).then(e=>{n(e)})}})})}return t._withIDBStore("readonly",t=>{r=t.get(e)}).then(()=>r.result)}function a(e,t=s()){return t._withIDBStore("readwrite",t=>{t.delete(e)})}function c(e=s()){const t=[];return e._withIDBStore("readonly",e=>{(e.openKeyCursor||e.openCursor).call(e).onsuccess=function(){this.result&&(t.push(this.result.key),this.result.continue())}}).then(()=>t)}return e.Store=t,e.get=l,e.set=function(e,t,r=s(),n=0){return r._withIDBStore("readwrite",r=>{r.put(t,e)}).then(function(){if(n){let t=u(r.dbName),i={timestamp:o(),validUntil:o()+n,store:r.storeName,key:e};e=r.storeName+"_"+e,t._withIDBStore("readwrite",t=>{t.put(i,e)})}})},e.del=a,e.clear=function(e=s()){return e._withIDBStore("readwrite",e=>{e.clear()})},e.keys=c,e}({});